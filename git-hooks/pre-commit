#!/bin/sh

echo "ğŸ”§ Running image compression and JSON generation..."
echo ""


node compress-images.js


# Check if the script succeeded
if [ $? -ne 0 ]; then
  echo "âŒ Compression or JSON generation failed. Commit aborted."
  exit 1
fi


echo ""
echo "ğŸ“ Here are the files staged for commit (after compression):"
echo "------------------------------------------------------------"
git status
echo "------------------------------------------------------------"


# Important! force read from real terminal
while true; do
  echo ""
  echo "âœ… Proceed with committing these changes? (y/n): "
  read -r answer < /dev/tty

  case "$answer" in
    [yY])
      echo "âœ… Proceeding with commit..."
      git add --all
      break
      ;;
    [nN])
      echo "ğŸš« Commit aborted by user."
      exit 1
      ;;
    *)
      echo "âš ï¸  Invalid input. Please type 'y' (yes) or 'n' (no)."
      ;;
  esac
done